Code from http://the-art-of-ecc.com/
